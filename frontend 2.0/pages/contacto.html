<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Contacta con MarAzul - Estamos aquí para ayudarte con cualquier pregunta">
  <meta name="robots" content="index, follow">
  <title>Contacto - MarAzul | Tu Pescadería de Confianza</title>
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  
  <!-- Custom CSS -->
  <link rel="stylesheet" href="../css/variables.css">
  <link rel="stylesheet" href="../css/main.css">
  
  <style>
    .contact-info-card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .contact-info-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.1);
    }
    
    .icon-circle {
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
  </style>
</head>
<body>
  
  <!-- Header Container -->
  <div id="header-container"></div>
  
  <!-- Hero Section -->
  <section class="bg-primary text-white py-5">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 mx-auto text-center">
          <h1 class="display-4 fw-bold mb-3">Contáctanos</h1>
          <p class="lead">
            ¿Tienes alguna pregunta o sugerencia? Estamos aquí para ayudarte
          </p>
        </div>
      </div>
    </div>
  </section>
  
  <!-- Main Content -->
  <main class="container py-5">
    <div class="row g-5">
      
      <!-- Contact Info -->
      <div class="col-lg-4">
        <div class="sticky-lg-top" style="top: 2rem;">
          
          <h3 class="h4 fw-bold mb-4">Información de Contacto</h3>
          
          <!-- Phone -->
          <div class="contact-info-card card border-0 shadow-sm mb-3">
            <div class="card-body p-4">
              <div class="d-flex align-items-center">
                <div class="icon-circle bg-primary bg-opacity-10 rounded-circle me-3">
                  <i class="bi bi-telephone-fill text-primary fs-4"></i>
                </div>
                <div>
                  <h5 class="fw-semibold mb-1">Teléfono</h5>
                  <a href="tel:+56912345678" class="text-decoration-none text-muted">
                    +56 9 1234 5678
                  </a>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Email -->
          <div class="contact-info-card card border-0 shadow-sm mb-3">
            <div class="card-body p-4">
              <div class="d-flex align-items-center">
                <div class="icon-circle bg-primary bg-opacity-10 rounded-circle me-3">
                  <i class="bi bi-envelope-fill text-primary fs-4"></i>
                </div>
                <div>
                  <h5 class="fw-semibold mb-1">Email</h5>
                  <a href="mailto:contacto@marazul.cl" class="text-decoration-none text-muted">
                    contacto@marazul.cl
                  </a>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Address -->
          <div class="contact-info-card card border-0 shadow-sm mb-3">
            <div class="card-body p-4">
              <div class="d-flex align-items-start">
                <div class="icon-circle bg-primary bg-opacity-10 rounded-circle me-3">
                  <i class="bi bi-geo-alt-fill text-primary fs-4"></i>
                </div>
                <div>
                  <h5 class="fw-semibold mb-1">Dirección</h5>
                  <p class="text-muted mb-0">
                    Av. Principal 123<br>
                    Santiago, Chile
                  </p>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Hours -->
          <div class="contact-info-card card border-0 shadow-sm mb-4">
            <div class="card-body p-4">
              <div class="d-flex align-items-start">
                <div class="icon-circle bg-primary bg-opacity-10 rounded-circle me-3">
                  <i class="bi bi-clock-fill text-primary fs-4"></i>
                </div>
                <div>
                  <h5 class="fw-semibold mb-2">Horario de Atención</h5>
                  <p class="text-muted mb-1"><strong>Lunes - Viernes:</strong> 9:00 - 18:00</p>
                  <p class="text-muted mb-1"><strong>Sábado:</strong> 9:00 - 14:00</p>
                  <p class="text-muted mb-0"><strong>Domingo:</strong> Cerrado</p>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Social Media -->
          <div class="card border-0 shadow-sm">
            <div class="card-body p-4">
              <h5 class="fw-semibold mb-3">Síguenos en Redes Sociales</h5>
              <div class="d-flex gap-2">
                <a href="#" class="btn btn-outline-primary" aria-label="Síguenos en Facebook" title="Facebook">
                  <i class="bi bi-facebook"></i>
                </a>
                <a href="#" class="btn btn-outline-primary" aria-label="Síguenos en Instagram" title="Instagram">
                  <i class="bi bi-instagram"></i>
                </a>
                <a href="#" class="btn btn-outline-success" aria-label="Contáctanos por WhatsApp" title="WhatsApp">
                  <i class="bi bi-whatsapp"></i>
                </a>
                <a href="#" class="btn btn-outline-info" aria-label="Síguenos en Twitter" title="Twitter">
                  <i class="bi bi-twitter"></i>
                </a>
              </div>
            </div>
          </div>
          
        </div>
      </div>
      
      <!-- Contact Form -->
      <div class="col-lg-8">
        <div class="card border-0 shadow-sm">
          <div class="card-body p-4 p-md-5">
            
            <h3 class="h4 fw-bold mb-4">Envíanos un mensaje</h3>
            
            <!-- Alert Messages -->
            <div id="alert-container"></div>
            
            <!-- Form -->
            <form id="contact-form" novalidate>
              
              <!-- Honeypot (anti-spam) -->
              <div style="position: absolute; left: -5000px;" aria-hidden="true">
                <input type="text" name="website" tabindex="-1" autocomplete="off">
              </div>
              
              <div class="row g-3">
                
                <!-- Name -->
                <div class="col-md-6">
                  <label for="name" class="form-label fw-semibold">
                    Nombre Completo <span class="text-danger">*</span>
                  </label>
                  <input 
                    type="text" 
                    class="form-control" 
                    id="name" 
                    name="name"
                    placeholder="Juan Pérez"
                    required
                    autocomplete="name">
                  <div class="invalid-feedback">
                    El nombre es requerido.
                  </div>
                </div>
                
                <!-- Email -->
                <div class="col-md-6">
                  <label for="email" class="form-label fw-semibold">
                    Correo Electrónico <span class="text-danger">*</span>
                  </label>
                  <input 
                    type="email" 
                    class="form-control" 
                    id="email" 
                    name="email"
                    placeholder="tucorreo@ejemplo.com"
                    required
                    autocomplete="email">
                  <div class="invalid-feedback">
                    Por favor ingresa un correo válido.
                  </div>
                </div>
                
                <!-- Phone (optional) -->
                <div class="col-md-6">
                  <label for="phone" class="form-label fw-semibold">
                    Teléfono (Opcional)
                  </label>
                  <div class="input-group">
                    <span class="input-group-text">+56</span>
                    <input 
                      type="tel" 
                      class="form-control" 
                      id="phone" 
                      name="phone"
                      placeholder="912345678"
                      pattern="[0-9]{8,9}"
                      autocomplete="tel">
                  </div>
                  <div class="invalid-feedback">
                    Ingresa un teléfono válido (8-9 dígitos).
                  </div>
                </div>
                
                <!-- Subject -->
                <div class="col-md-6">
                  <label for="subject" class="form-label fw-semibold">
                    Asunto <span class="text-danger">*</span>
                  </label>
                  <select 
                    class="form-select" 
                    id="subject" 
                    name="subject"
                    required>
                    <option value="">Selecciona un asunto</option>
                    <option value="consulta-general">Consulta General</option>
                    <option value="pedido">Consulta sobre Pedido</option>
                    <option value="productos">Información de Productos</option>
                    <option value="sugerencia">Sugerencia</option>
                    <option value="reclamo">Reclamo</option>
                    <option value="otro">Otro</option>
                  </select>
                  <div class="invalid-feedback">
                    Por favor selecciona un asunto.
                  </div>
                </div>
                
                <!-- Message -->
                <div class="col-12">
                  <label for="message" class="form-label fw-semibold">
                    Mensaje <span class="text-danger">*</span>
                  </label>
                  <textarea 
                    class="form-control" 
                    id="message" 
                    name="message"
                    rows="6"
                    maxlength="500"
                    placeholder="Escribe tu mensaje aquí..."
                    required></textarea>
                  <div class="invalid-feedback">
                    El mensaje es requerido.
                  </div>
                  <div class="form-text d-flex justify-content-between">
                    <span><span id="char-count">0</span>/500 caracteres</span>
                    <span id="char-remaining"></span>
                  </div>
                </div>
                
                <!-- Privacy Policy -->
                <div class="col-12">
                  <div class="form-check">
                    <input 
                      class="form-check-input" 
                      type="checkbox" 
                      id="privacy" 
                      name="privacy"
                      required>
                    <label class="form-check-label" for="privacy">
                      Acepto la <a href="#" class="text-decoration-none">política de privacidad</a> 
                      y el tratamiento de mis datos personales
                    </label>
                    <div class="invalid-feedback">
                      Debes aceptar la política de privacidad.
                    </div>
                  </div>
                </div>
                
                <!-- Submit Button -->
                <div class="col-12 mt-4">
                  <button 
                    type="submit" 
                    class="btn btn-primary px-5 py-2"
                    id="submit-btn">
                    <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                    <span class="btn-text">
                      <i class="bi bi-send me-2"></i>Enviar Mensaje
                    </span>
                  </button>
                  <div class="form-text mt-2" id="rate-limit-message" style="display: none;">
                    <i class="bi bi-info-circle me-1"></i>
                    <span id="rate-limit-text"></span>
                  </div>
                </div>
                
              </div>
              
            </form>
            
          </div>
        </div>
        
        <!-- FAQ Section -->
        <div class="card border-0 shadow-sm mt-4">
          <div class="card-body p-4">
            <h4 class="fw-bold mb-4">Preguntas Frecuentes</h4>
            
            <div class="accordion" id="faqAccordion">
              
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq1" aria-expanded="false" aria-controls="faq1">
                    ¿Cuál es el tiempo de entrega?
                  </button>
                </h2>
                <div id="faq1" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                  <div class="accordion-body">
                    Los pedidos se entregan en un plazo de 24-48 horas hábiles dentro de Santiago. Para otras regiones, el plazo puede extenderse a 3-5 días hábiles.
                  </div>
                </div>
              </div>
              
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2" aria-expanded="false" aria-controls="faq2">
                    ¿Cómo garantizan la frescura de los productos?
                  </button>
                </h2>
                <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                  <div class="accordion-body">
                    Todos nuestros productos son seleccionados diariamente y mantenidos en condiciones óptimas de refrigeración. Garantizamos productos del día con certificación de origen.
                  </div>
                </div>
              </div>
              
              <div class="accordion-item">
                <h2 class="accordion-header">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3" aria-expanded="false" aria-controls="faq3">
                    ¿Cuáles son los métodos de pago?
                  </button>
                </h2>
                <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                  <div class="accordion-body">
                    Aceptamos tarjetas de crédito, débito, transferencia bancaria y pago contra entrega. También puedes pagar con Webpay y Mercado Pago.
                  </div>
                </div>
              </div>
              
            </div>
          </div>
        </div>
        
      </div>
      
    </div>
  </main>
  
  <!-- Footer Container -->
  <div id="footer-container"></div>
  
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- Custom JS -->
  <script type="module">
    import { showAlert, validateForm, setButtonLoading } from '../js/utils.js';
    
    // Rate limiting
    let lastSubmitTime = 0;
    const RATE_LIMIT_MS = 60000; // 1 minute
    
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('contact-form');
      const submitBtn = document.getElementById('submit-btn');
      const messageInput = document.getElementById('message');
      const charCount = document.getElementById('char-count');
      const charRemaining = document.getElementById('char-remaining');
      const rateLimitMessage = document.getElementById('rate-limit-message');
      const rateLimitText = document.getElementById('rate-limit-text');
      
      // Character counter
      messageInput?.addEventListener('input', () => {
        const length = messageInput.value.length;
        const maxLength = 500;
        charCount.textContent = length;
        
        const remaining = maxLength - length;
        if (remaining <= 50) {
          charRemaining.textContent = `${remaining} caracteres restantes`;
          charRemaining.classList.add('text-warning');
        } else {
          charRemaining.textContent = '';
          charRemaining.classList.remove('text-warning');
        }
        
        if (length > maxLength) {
          messageInput.value = messageInput.value.substring(0, maxLength);
          charCount.textContent = maxLength;
        }
      });
      
      // Handle form submit
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        // Check honeypot
        const honeypot = form.querySelector('input[name="website"]');
        if (honeypot && honeypot.value) {
          console.log('Spam detected');
          return;
        }
        
        // Check rate limit
        const now = Date.now();
        if (now - lastSubmitTime < RATE_LIMIT_MS) {
          const remainingTime = Math.ceil((RATE_LIMIT_MS - (now - lastSubmitTime)) / 1000);
          rateLimitText.textContent = `Por favor espera ${remainingTime} segundos antes de enviar otro mensaje.`;
          rateLimitMessage.style.display = 'block';
          return;
        }
        
        if (!validateForm(form)) return;
        
        const formData = new FormData(form);
        const contactData = {
          name: formData.get('name'),
          email: formData.get('email'),
          phone: formData.get('phone'),
          subject: formData.get('subject'),
          message: formData.get('message')
        };
        
        setButtonLoading(submitBtn, true, 'Enviando...');
        rateLimitMessage.style.display = 'none';
        
        try {
          // TODO: Replace with actual API call
          // const response = await ContactService.send(contactData);
          
          // Simulate API call
          await new Promise(resolve => setTimeout(resolve, 1500));
          
          showAlert('success', '¡Mensaje enviado exitosamente! Te responderemos a la brevedad.');
          form.reset();
          charCount.textContent = '0';
          charRemaining.textContent = '';
          form.classList.remove('was-validated');
          
          // Update last submit time
          lastSubmitTime = Date.now();
          
        } catch (error) {
          console.error('Contact error:', error);
          showAlert('danger', 'Error al enviar el mensaje. Por favor intenta nuevamente.');
        } finally {
          setButtonLoading(submitBtn, false);
        }
      });
    });
  </script>
  
</body>
</html>